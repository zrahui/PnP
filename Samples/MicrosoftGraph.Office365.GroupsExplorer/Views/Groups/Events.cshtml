@model IEnumerable<OfficeDevPnP.MSGraphAPIGroups.Models.Event>

<div class="ms-Grid-row ms-bgColor-themeDark ">

	<div class="ms-Grid-col ms-u-sm12">
		<h2 class="ms-font-xxl ms-fontColor-white">
			@ViewBag.Title
		</h2>
	</div>
</div>

<div class="ms-Grid-row">
	<div class="ms-Grid-col ms-u-sm12">
		@if (!String.IsNullOrEmpty(ViewBag.Message))
		{
			<h4 class="ms-font-xl">@ViewBag.Message</h4>
		}
	</div>
</div>

<div class="ms-Grid-row">
	<div class="ms-Grid-col ms-u-sm12">
		<div class="ms-CommandBar">
			<div class="ms-CommandBar-sideCommands">
				<div class="ms-CommandBarItem">
					<div class="ms-CommandBarItem-linkWrapper">
						<a class="ms-CommandBarItem-link" tabindex="1" href="@Url.Action("Details", new { id = ViewBag.GroupId })">
							<span class="ms-CommandBarItem-icon ms-Icon ms-Icon--reactivate"></span>
							<span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular">Back to Group Details</span>
						</a>
					</div>
				</div>
			</div>
			<div class="ms-CommandBar-mainArea">
			</div>
		</div>
	</div>
</div>

<div class="ms-Grid-row">
	<div class="ms-Grid-col ms-u-sm12">

		<div class="ms-Table">
			<div class="ms-Table-row">
				<span class="ms-Table-cell">@Html.DisplayNameFor(model => model.subject)</span>
				<span class="ms-Table-cell">@Html.DisplayNameFor(model => model.bodyPreview)</span>
				<span class="ms-Table-cell">@Html.DisplayNameFor(model => model.start)</span>
				<span class="ms-Table-cell">@Html.DisplayNameFor(model => model.end)</span>
				<span class="ms-Table-cell">@Html.DisplayNameFor(model => model.isAllDay)</span>
				<span class="ms-Table-cell">@Html.DisplayNameFor(model => model.attendees)</span>
			</div>

			@foreach (var item in Model)
			{
				string attendees = String.Join<OfficeDevPnP.MSGraphAPIGroups.Models.Attendee>("<br/>", item.attendees);
				<div class="ms-Table-row">
					<span class="ms-Table-cell">
						@Html.DisplayFor(modelItem => item.subject)
					</span>
					<span class="ms-Table-cell">
						@Html.DisplayFor(modelItem => item.bodyPreview)
					</span>
					<span class="ms-Table-cell">
						@Html.DisplayFor(modelItem => item.start)
					</span>
					<span class="ms-Table-cell">
						@Html.DisplayFor(modelItem => item.end)
					</span>
					<span class="ms-Table-cell">
						@Html.DisplayFor(modelItem => item.isAllDay)
					</span>
					<span class="ms-Table-cell">
						@*				@Html.DisplayFor(modelItem => item.attendees)*@
						@Html.Raw(attendees)
					</span>
				</div>
			}
		</div>

	</div>
</div>
